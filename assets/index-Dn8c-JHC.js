import{initializeApp as b}from"https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";import{getFirestore as f,collection as h,getDocs as C}from"https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&p(s)}).observe(document,{childList:!0,subtree:!0});function m(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function p(o){if(o.ep)return;o.ep=!0;const r=m(o);fetch(o.href,r)}})();window.onload=()=>{const u=b({apiKey:"AIzaSyAKJ_MIyMk1dIgJYVYP25A2HSFQySsB04g",authDomain:"ccc-data-store.firebaseapp.com",projectId:"ccc-data-store",storageBucket:"ccc-data-store.appspot.com",messagingSenderId:"1084448372624",appId:"1:1084448372624:web:7461eb99124e29f9346515",measurementId:"G-YYC20JLCP7"}),m=f(u),p=h(m,"markers");async function o(){try{const l=await C(p),a=[];return l.forEach(n=>{a.push({id:n.id,...n.data()})}),console.log("Markers List:",a),console.log("Marker:",a[0].equipment),a}catch(l){return console.error("Error reading document: ",l),[]}}const r=document.querySelector("a-scene"),s=document.createElement("a-entity");s.setAttribute("cursor","rayOrigin: mouse; fuse: false;"),s.setAttribute("raycaster","objects: a-box, a-image"),s.setAttribute("raycaster","ignore: [canvas]"),s.setAttribute("raycaster","objects: .clickable; showLine: true;"),r.camera.el.appendChild(s),console.log("Cursor entity added to scene");const y=["red","green","yellow","blue"];navigator.geolocation.getCurrentPosition(async()=>{(await o()).forEach((n,e)=>{const t=document.createElement("a-entity");t.setAttribute("gps-entity-place",`latitude: ${n.location.lat}; longitude: ${n.location.lng};`),t.setAttribute("look-at","[gps-camera]"),t.setAttribute("scale","6 6 6"),t.setAttribute("class","clickable"),t.setAttribute("id",`place-${e}`);const c=document.createElement("a-image");c.setAttribute("src","cube-logo-100.png"),c.setAttribute("scale","1 1 1"),c.setAttribute("position","0 0 0"),t.appendChild(c);const i=document.createElement("a-box");i.setAttribute("class","clickable"),i.setAttribute("material",`color: ${y[e]}; opacity: 0.5`),i.setAttribute("scale","1.5 1.5 0.1"),i.setAttribute("position","0 0 0"),t.appendChild(i),t.addEventListener("click",function(){console.log(`Clicked on ${n.equipment}`),a(n)}),r.appendChild(t)});function a(n){const e=document.createElement("div");e.setAttribute("id","landmark-modal"),e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(255, 255, 255, 0.95)",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="left",e.style.justifyContent="center",e.style.padding="20px",e.style.boxSizing="border-box";const t=document.createElement("div");t.innerHTML="&times;",t.style.position="absolute",t.style.top="20px",t.style.right="20px",t.style.fontSize="30px",t.style.cursor="pointer",t.onclick=()=>{document.body.removeChild(e)},e.appendChild(t);const c=document.createElement("h2");c.innerText=n.equipment,e.appendChild(c);const i=document.createElement("p");i.innerHTML=`
                <strong>Operation:</strong> ${n.operation}<br>
                <strong>Control:</strong> ${n.control}<br>
                <strong>Control Framework:</strong> ${n.framework}<br>
                <strong>Operating Context:</strong> ${n.context}<br>
                <strong>Equipment:</strong> ${n.equipment}<br>
                <strong>Location:</strong> ${n.location.lat}, ${n.location.lng}<br>
            `,e.appendChild(i);const d=document.createElement("button");d.innerText="Perform CCC",d.style.marginTop="10px",d.style.padding="10px 20px",d.style.cursor="pointer",d.onclick=()=>{window.open(n.url,"_blank")},e.appendChild(d),document.body.appendChild(e)}},l=>{console.error("Error retrieving location",l)},{enableHighAccuracy:!0,maximumAge:0,timeout:27e3})};
