import{initializeApp as b}from"https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";import{getFirestore as y,collection as f,getDocs as h}from"https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&p(s)}).observe(document,{childList:!0,subtree:!0});function m(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function p(o){if(o.ep)return;o.ep=!0;const n=m(o);fetch(o.href,n)}})();window.onload=()=>{const u=b({apiKey:"AIzaSyAKJ_MIyMk1dIgJYVYP25A2HSFQySsB04g",authDomain:"ccc-data-store.firebaseapp.com",projectId:"ccc-data-store",storageBucket:"ccc-data-store.appspot.com",messagingSenderId:"1084448372624",appId:"1:1084448372624:web:7461eb99124e29f9346515",measurementId:"G-YYC20JLCP7"}),m=y(u),p=f(m,"markers");async function o(){try{const l=await h(p),a=[];return l.forEach(r=>{a.push({id:r.id,...r.data()})}),console.log("Markers List:",a),console.log("Marker:",a[0].equipment),a}catch(l){return console.error("Error reading document: ",l),[]}}const n=document.querySelector("a-scene"),s=document.createElement("a-entity");s.setAttribute("cursor","rayOrigin: mouse; fuse: false;"),s.setAttribute("raycaster","objects: a-box, a-gltf-model"),s.setAttribute("raycaster","ignore: [canvas]"),s.setAttribute("raycaster","objects: .clickable; showLine: true;"),n.camera.el.appendChild(s),console.log("Cursor entity added to scene"),navigator.geolocation.getCurrentPosition(async()=>{(await o()).forEach((r,e)=>{const t=document.createElement("a-entity");t.setAttribute("gps-entity-place",`latitude: ${r.location.lat}; longitude: ${r.location.lng};`),t.setAttribute("look-at","[gps-camera]"),t.setAttribute("scale","6 6 6"),t.setAttribute("class","clickable"),t.setAttribute("id",`place-${e}`);const i=document.createElement("a-gltf-model");i.setAttribute("src","Shiny Amberis-Amur.glb"),i.setAttribute("scale","0.1 0.1 0.1"),i.setAttribute("look-at","[gps-camera]"),i.setAttribute("class","clickable"),t.appendChild(i);const c=document.createElement("a-box");c.setAttribute("class","clickable"),c.setAttribute("material","color: transparent; opacity: 0.0"),c.setAttribute("scale","2 2 0"),c.setAttribute("position","0 0 0"),t.appendChild(c),t.addEventListener("click",function(){console.log(`Clicked on ${r.equipment}`),a(r)}),n.appendChild(t)});function a(r){const e=document.createElement("div");e.setAttribute("id","landmark-modal"),e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(255, 255, 255, 0.95)",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="left",e.style.justifyContent="center",e.style.padding="20px",e.style.boxSizing="border-box";const t=document.createElement("div");t.innerHTML="&times;",t.style.position="absolute",t.style.top="20px",t.style.right="20px",t.style.fontSize="30px",t.style.cursor="pointer",t.onclick=()=>{document.body.removeChild(e)},e.appendChild(t);const i=document.createElement("h2");i.innerText=r.equipment,e.appendChild(i);const c=document.createElement("p");c.innerHTML=`
                <strong>Operation:</strong> ${r.operation}<br>
                <strong>Control:</strong> ${r.control}<br>
                <strong>Control Framework:</strong> ${r.framework}<br>
                <strong>Operating Context:</strong> ${r.context}<br>
                <strong>Equipment:</strong> ${r.equipment}<br>
                <strong>Location:</strong> ${r.location.lat}, ${r.location.lng}<br>
            `,e.appendChild(c);const d=document.createElement("button");d.innerText="Perform CCC",d.style.marginTop="10px",d.style.padding="10px 20px",d.style.cursor="pointer",d.onclick=()=>{window.open(r.url,"_blank")},e.appendChild(d),document.body.appendChild(e)}},l=>{console.error("Error retrieving location",l)},{enableHighAccuracy:!0,maximumAge:0,timeout:27e3})};
